webpackJsonp([2],{"./client/components/article-index/index.scss":function(e,t){},"./client/components/article/index.scss":function(e,t){},"./client/components/skeleton-article/index.scss":function(e,t){},"./client/container/article/index.jsx":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("./node_modules/react/index.js"),s=a.n(n),c=a("./node_modules/react-redux/es/index.js"),l=a("./client/actions/index.js"),r=a("./client/constants/index.js"),i=a("./client/util/scroll.js"),o=(a("./client/container/article/index.scss"),a("./client/components/message-board/index.jsx")),m=a("./node_modules/react-router-dom/es/index.js"),d=(a("./client/components/article/index.scss"),a("./client/components/article-index/index.scss"),a("./node_modules/classnames/index.js")),p=a.n(d);var u,h=({index:e,scrollToContent:t,content:a,title:c,date:l,tags:r,previous:i,next:o})=>s.a.createElement("section",{className:"article-wrapper"},s.a.createElement("h1",null,c),s.a.createElement("p",{className:"subtitle"},s.a.createElement("span",{className:"time"},s.a.createElement("i",{className:"iconfont icon-time"}),l)," ",s.a.createElement("span",{className:"tags"},s.a.createElement("i",{className:"iconfont icon-tag"}),r&&r.split(",").map(e=>s.a.createElement(m.b,{to:`/archives?topic=${encodeURI(e)}`,key:e},e)))," "),s.a.createElement(class extends n.PureComponent{constructor(...e){var t;return t=super(...e),this.state={menuVisible:!0},this.handleMenu=(e=>{e.preventDefault(),this.setState(e=>({menuVisible:!e.menuVisible}))}),t}render(){var e=this.props;const t=e.index,a=e.scrollToContent,n=this.state.menuVisible;return t&&0!==t.length?s.a.createElement("div",{className:"article-index"},s.a.createElement("p",{className:"title"},"索引",s.a.createElement("span",null,"[",s.a.createElement("a",{onClick:this.handleMenu,href:"#"},!0===n?"隐藏":"显示"),"]")),s.a.createElement("ul",{className:p()({"article-index-main":!0,active:n}),onClickCapture:a},t.map(({anchor:e,content:t,tag:a})=>s.a.createElement("li",{key:e,className:`tag-${a}`},s.a.createElement("a",{href:`#${e}`},t))))):null}},{index:e,scrollToContent:t}),s.a.createElement("article",{className:"article markdown-body",dangerouslySetInnerHTML:{__html:a}}),(i||o)&&s.a.createElement("p",{className:"pager"},i&&s.a.createElement("div",{className:"previous"},s.a.createElement(m.b,{onClick:()=>window.scrollTo(0,0),to:`/article/${i.url}`},s.a.createElement("span",null,"PREVIOUS"),i.title)),s.a.createElement("div",{className:"placeholder"}),o&&s.a.createElement("div",{className:"next"},s.a.createElement(m.b,{onClick:()=>{window.scrollTo(0,0)},to:`/article/${o.url}`},s.a.createElement("span",null,"NEXT"),o.title)))),E=(a("./client/components/skeleton-article/index.scss"),()=>s.a.createElement("section",{className:"skeleton-article"},s.a.createElement("div",{className:"skeleton-article-item"},s.a.createElement("div",{className:"animated-background title"}),s.a.createElement("div",{className:"index-wrapper"},s.a.createElement("div",{className:"animated-background index"})),s.a.createElement("div",{className:"content"},[1,2,3,4,5,6,7,8,9,10,11,12,13,14].map(e=>s.a.createElement("div",{key:e,className:"desc"},s.a.createElement("div",{className:"animated-background"}))))))),x=a("./client/util/cache.js"),v=a("./client/services/sql.js"),N=a.n(v);a.d(t,"default",function(){return f});var T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};let f=Object(c.b)(e=>T({},e.article,e.comment),(e,t)=>({fetchPostData:t=>{e(Object(l.e)(t))},addComment:t=>{e(Object(l.a)(t))}}))(u=class extends n.PureComponent{constructor(...e){var t;return t=super(...e),this.addComment=(e=>{e.postId=this.props.article._id,e.createdTime=Date.now(),this.props.addComment(e)}),t}componentDidMount(){const e=this.props.state;if(e===r.INITIAL_STATE||e===r.FAILURE_STATE)this.props.fetchPostData({url:this.props.match.params.url});else if(e===r.SUCCESS_STATE){if(this.props.match.params.url===this.props.article.url){const e=N.a.postSQL({url:this.props.match.params.url});Object(x.a)(`/graphql?query=${N.a.encode(e.query)}`,{data:{post:T({},this.props.article,{comments:this.props.comments})}})}else this.props.fetchPostData({url:this.props.match.params.url})}}componentWillReceiveProps(e){const t=e.article.url,a=e.match.params.url;e.state===r.SUCCESS_STATE&&t!==a&&this.props.fetchPostData({url:e.match.params.url})}scrollToContent(e){e.preventDefault();try{const t=e.target.hash.slice(1),a=document.getElementById(t);i.a.call(this,a,500)}catch(e){}}render(){var e=this.props;const t=e.article,a=e.state,n=e.comments;switch(a){case r.INITIAL_STATE:case r.LOADING_STATE:return s.a.createElement(E,null);case r.SUCCESS_STATE:return[s.a.createElement(h,T({key:"article"},t,{scrollToContent:this.scrollToContent})),s.a.createElement(o.a,{key:"message-board",submit:this.addComment,comments:n})];default:return s.a.createElement("section",{className:"loading-failure"},"系统繁忙，请稍后重试")}}})||u},"./client/container/article/index.scss":function(e,t){}});