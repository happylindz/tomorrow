exports.ids=[3],exports.modules={124:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"default",function(){return E});var a,r=n(0),c=n.n(r),o=n(6),s=(n.n(o),n(144)),i=n(147),u=n(130),p=n(5),l=(n.n(p),n(129)),d=n.n(l),m=n(2),f=n(4),v=n(132),h=n(149),y=(n.n(h),function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}()),g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};var E=Object(o.connect)(function(e){return g({},e.posts)},function(e){return{fetchPostsData:function(t){e(Object(u.f)(t))}}})(a=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return c.fetchPostsData=function(){var e=c.props,t=e.posts,n=e.end,a=e.loading,r=t.length;if(!n&&a!==p.LOADING_STATE&&a!==p.FAILURE_STATE){var o={time:t[r-1].time},s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;document.getElementById("posts-main").getBoundingClientRect().bottom<s&&c.props.fetchPostsData(o)}},c.fetchPostsData=Object(f.a)(c.fetchPostsData,100),c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["PureComponent"]),y(t,[{key:"componentDidMount",value:function(){setTimeout(function(){window.scrollTo(0,0)});var e=this.props.state;if(e===p.INITIAL_STATE||e===p.FAILURE_STATE)this.props.fetchPostsData();else{var t=d.a.postsSQL({size:10});Object(v.a)("/graphql?query="+d.a.encode(t.query),{data:{posts:{posts:this.props.posts,end:this.props.end}}})}m.a.addHandler(window,"scroll",this.fetchPostsData)}},{key:"componentWillUnmount",value:function(){m.a.removeHandler(window,"scroll",this.fetchPostsData)}},{key:"render",value:function(){var e=this.props,t=e.posts,n=e.state,a=e.end,r=e.loading;switch(n){case p.INITIAL_STATE:case p.LOADING_STATE:return c.a.createElement(i.a,null);case p.SUCCESS_STATE:return c.a.createElement(s.a,{posts:t,end:a,loading:r,state:n});default:return c.a.createElement("section",{className:"loading-failure"},"系统繁忙，请稍后重试")}}}]),t}())||a},129:function(e,t){t.encode=function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")},t.postsSQL=function(e){var t=null;return e.time&&e.size?t='(time: "'+e.time+'", size: '+e.size+")":e.size&&(t="(size: "+e.size+")"),{query:"{\n      posts"+t+" {\n        posts {\n          cover\n          desc\n          date\n          title\n          readCount\n          commentCount\n          _id\n          tags\n          url\n          time\n        }\n        end\n      }\n    }"}},t.postSQL=function(e){return{query:'{\n      post(url: "'+e.url+'") {\n        _id\n        title\n        tags\n        content\n        date\n        url\n        next {\n          title\n          url\n        }\n        index {\n          tag\n          content\n          anchor\n        }\n        previous {\n          title\n          url\n        }\n        comments {\n          _id\n          name\n          time\n          content\n          refTo {\n            _id\n            name\n            content\n          }\n        }\n      }\n    }'}},t.archivesSQL=function(){return{query:"{\n      posts {\n        posts {\n          title\n          _id\n          tags\n          url\n          year\n          day\n        }\n      }\n    }"}},t.infoSQL=function(){return{query:"{\n      info {\n        _id\n        html\n        comments {\n          _id\n          name\n          time\n          content\n          refTo {\n            _id\n            name\n            content\n          }\n        }\n      }\n    }"}},t.projectsSQL=function(){return{query:"{\n      projects {\n        projects {\n          _id\n          title\n          href\n          html\n        }\n      }\n    }"}}},130:function(e,t,n){"use strict";n.d(t,"g",function(){return s}),n.d(t,"d",function(){return i}),n.d(t,"f",function(){return u}),n.d(t,"c",function(){return p}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return v});var a=n(7),r=n(131),c=this;function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(r,c){try{var o=t[r](c),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}("next")})}}var s=function(){return e=o(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:a.x}),e.prev=1,e.next=4,Object(r.i)();case 4:if(!(200===(n=e.sent).status&&n.data&&n.data.data&&n.data.data.projects)){e.next=9;break}t({type:a.z,payload:n.data.data.projects}),e.next=10;break;case 9:throw new Error("获取数据失败");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t({type:a.y});case 15:case"end":return e.stop()}},e,c,[[1,12]])})),function(t){return e.apply(this,arguments)};var e},i=function(){return e=o(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:a.c}),e.prev=1,e.next=4,Object(r.e)();case 4:if(!(200===(n=e.sent).status&&n.data&&n.data.data&&n.data.data.info)){e.next=10;break}t({type:a.e,payload:n.data.data.info}),n.data.data.info.comments&&t({type:a.q,payload:{comments:n.data.data.info.comments}}),e.next=11;break;case 10:throw new Error("获取数据失败");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t({type:a.d});case 16:case"end":return e.stop()}},e,c,[[1,13]])})),function(t){return e.apply(this,arguments)};var e},u=function(e){return t=o(regeneratorRuntime.mark(function t(n){var o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e&&e.time?n({type:a.t}):(e={},n({type:a.r})),e.size=10,t.prev=2,t.next=5,Object(r.h)(e);case 5:if(!(200===(o=t.sent).status&&o.data&&o.data.data&&o.data.data.posts)){t.next=11;break}s=o.data.data.posts,e&&e.time?n({type:a.v,payload:s}):n({type:a.w,payload:s}),t.next=12;break;case 11:throw new Error("获取数据失败");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),e&&e.time?n({type:a.u}):n({type:a.s});case 17:case"end":return t.stop()}},t,c,[[2,14]])})),function(e){return t.apply(this,arguments)};var t},p=function(){return e=o(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:a.f}),e.prev=1,e.next=4,Object(r.c)();case 4:if(!(200===(n=e.sent).status&&n.data&&n.data.data&&n.data.data.posts)){e.next=9;break}t({type:a.h,payload:n.data.data.posts}),e.next=10;break;case 9:throw new Error("获取数据失败");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t({type:a.g});case 15:case"end":return e.stop()}},e,c,[[1,12]])})),function(t){return e.apply(this,arguments)};var e},l=function(e){return t=o(regeneratorRuntime.mark(function t(n){var o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:a.i}),t.prev=1,t.next=4,Object(r.g)(e);case 4:if(!(200===(o=t.sent).status&&o.data&&o.data.data&&o.data.data.post)){t.next=12;break}s=o.data.data.post.comments,o.data.data.post.comments=null,n({type:a.k,payload:o.data.data.post}),s&&n({type:a.n,payload:{comments:s}}),t.next=13;break;case 12:throw new Error("获取数据失败");case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),n({type:a.j});case 18:case"end":return t.stop()}},t,c,[[1,15]])})),function(e){return t.apply(this,arguments)};var t},d=function(e){return t=o(regeneratorRuntime.mark(function t(n){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:a.l}),t.prev=1,t.next=4,Object(r.d)(e);case 4:if(!(200===(o=t.sent).status&&o.data&&o.data.data&&o.data.data.comments)){t.next=9;break}n({type:a.n,payload:o.data.data.comments}),t.next=10;break;case 9:throw new Error("获取数据失败");case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),n({type:a.m});case 15:case"end":return t.stop()}},t,c,[[1,12]])})),function(e){return t.apply(this,arguments)};var t},m=function(e){return t=o(regeneratorRuntime.mark(function t(n){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(r.a)(e);case 3:return 200===(o=t.sent).status&&0===o.data.code&&n(d({postId:e.postId})),t.abrupt("return",o.data);case 8:t.prev=8,t.t0=t.catch(0),n({type:a.a});case 11:case"end":return t.stop()}},t,c,[[0,8]])})),function(e){return t.apply(this,arguments)};var t},f=function(){return e=o(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:a.o}),e.prev=1,e.next=4,Object(r.f)();case 4:if(!(200===(n=e.sent).status&&n.data&&n.data.data&&n.data.data.message)){e.next=9;break}t({type:a.q,payload:n.data.data.message}),e.next=10;break;case 9:throw new Error("获取数据失败");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t({type:a.p});case 15:case"end":return e.stop()}},e,c,[[1,12]])})),function(t){return e.apply(this,arguments)};var e},v=function(e){return t=o(regeneratorRuntime.mark(function t(n){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(r.b)(e);case 3:return 200===(o=t.sent).status&&0===o.data.code&&n(f()),t.abrupt("return",o.data);case 8:t.prev=8,t.t0=t.catch(0),n({type:a.b});case 11:case"end":return t.stop()}},t,c,[[0,8]])})),function(e){return t.apply(this,arguments)};var t}},131:function(e,t,n){"use strict";n.d(t,"i",function(){return s}),n.d(t,"h",function(){return i}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return p}),n.d(t,"g",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"f",function(){return m}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return v});var a=n(122),r=n.n(a),c=n(129),o=n.n(c);r.a.interceptors.request.use(function(e){var t,n,a,r=(t=new RegExp("(^| )"+"csrfToken"+"=([^;]*)(;|$)"),(n=document.cookie.match(t))?unescape(n[2]):null);return a=e.method,/^(get|head|options|trace)$/.test(a)||(e.headers["x-csrf-token"]=r),e},function(e){return Promise.reject(e)});var s=function(){return r.a.get("/graphql",{params:o.a.projectsSQL()})},i=function(e){return r.a.get("/graphql",{params:o.a.postsSQL(e)})},u=function(){return r.a.get("/graphql",{params:o.a.archivesSQL()})},p=function(){return r.a.get("/graphql",{params:o.a.infoSQL()})},l=function(e){return r.a.get("/graphql",{params:o.a.postSQL(e)})},d=function(e){return r.a.get("/graphql",{params:{query:'{\n        comments(postId: "'+e.postId+'"){\n          comments {\n            _id\n            name\n            time\n            content\n            refTo {\n              _id\n              name\n              time\n              content\n            }\n          }\n        }\n      }'}})},m=function(){return r.a.get("/graphql",{params:{query:"{\n        message{\n          comments {\n            _id\n            name\n            time\n            content\n            refTo {\n              _id\n              name\n              time\n              content\n            }\n          }\n        }\n      }"}})},f=function(e){return r.a.post("/api/comment",e)},v=function(e){return r.a.post("/api/message",e)}},132:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(5),r=n.n(a).a.apiCacheName,c=function(e,t){"caches"in window&&caches.open(r).then(function(n){n.put(e,new Response(JSON.stringify(t),{status:200}))})}},143:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(0),r=n.n(a),c=n(146),o=(n.n(c),function(){return r.a.createElement("div",{className:"skeleton-home-item"},r.a.createElement("div",{className:"animated-background title"}),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"animated-background"})),r.a.createElement("div",{className:"desc-wrapper"},r.a.createElement("div",{className:"desc"},r.a.createElement("div",{className:"animated-background"})),r.a.createElement("div",{className:"desc"},r.a.createElement("div",{className:"animated-background"})))))});t.b=function(){return r.a.createElement("div",{className:"skeleton-home"},[1,2,3,4,5,6].map(function(e){return r.a.createElement(o,{key:e})}))}},144:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(3),o=(n.n(c),n(1)),s=n.n(o),i=n(145),u=(n.n(i),n(5)),p=n.n(u),l=n(143);t.a=function(e){var t=e.posts,n=e.end,a=e.loading,o=e.state;return r.a.createElement("section",{className:"home-wrapper"},r.a.createElement("div",{id:"posts-main",className:"posts-main"},t.length>0?t.map(function(e){return r.a.createElement("section",{className:"post-item",key:e._id},r.a.createElement("h3",{className:"title"},r.a.createElement(c.Link,{onClick:function(){window.scrollTo(0,0)},to:"/article/"+e.url},e.title)),r.a.createElement("p",{className:"subtitle"},r.a.createElement("span",{className:"time"},r.a.createElement("i",{className:"iconfont icon-time"}),e.date)," ",r.a.createElement("span",{className:"tags"},r.a.createElement("i",{className:"iconfont icon-tag"}),e.tags.split(",").map(function(e){return r.a.createElement(c.Link,{to:"/archives?topic="+encodeURI(e),key:e},e)}))," "),r.a.createElement(c.Link,{onClick:function(){window.scrollTo(0,0)},to:"/article/"+e.url,className:"content"},e.cover&&r.a.createElement("div",{className:"cover"},r.a.createElement("img",{src:e.cover})),r.a.createElement("div",{className:"desc"},r.a.createElement("span",{className:"text"},e.desc))),r.a.createElement("div",{className:"footer"},r.a.createElement("span",null,"阅读(",e.readCount,")"),r.a.createElement(c.Link,{to:"/article/"+e.url+"#comments"},"评论(",e.commentCount,")")))}):r.a.createElement("p",{className:"no-posts"},"暂无博文")),r.a.createElement("div",{id:"loading",className:s()({loading:!0,active:a===p.a.LOADING_STATE&&o===p.a.SUCCESS_STATE,failure:a===p.a.FAILURE_STATE&&o===p.a.SUCCESS_STATE})},a===p.a.LOADING_STATE?r.a.createElement(l.a,null):"系统繁忙，请稍后重试"),r.a.createElement("p",{className:s()({"no-more-posts":!0,active:n&&t.length>0})},"没有更多的文章了"))}},145:function(e,t){},146:function(e,t){},147:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(148),o=(n.n(c),n(143));t.a=function(){return r.a.createElement("section",{className:"skeleton-wrapper"},r.a.createElement(o.b,null))}},148:function(e,t){},149:function(e,t){}};